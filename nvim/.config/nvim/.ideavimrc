" ============================================================================
" IdeaVim Configuration
" ============================================================================
" Purpose: IntelliJ IDEA Vim emulation configuration
"
" Structure:
"   1. Source shared configuration (keyboard layout, shared mappings)
"   2. IntelliJ-specific settings
"   3. IntelliJ-specific mappings (shared across both keyboards)
"   4. Keyboard-specific prefix mappings (sourced conditionally)
" ============================================================================

" ----------------------------------------------------------------------------
" Source Shared Configuration
" ----------------------------------------------------------------------------
source ~/.config/nvim/keyboard-layout.vim
source ~/.config/nvim/shared-mappings.vim

" ----------------------------------------------------------------------------
" Source Keyboard-Specific Prefix Mappings
" ----------------------------------------------------------------------------
" Load ALT-based (SE) or CTRL-based (US) prefix mappings based on keyboard layout

if g:keyboard_layout == "SE"
    source ~/.config/nvim/ideavim-se.vim
elseif g:keyboard_layout == "US"
    source ~/.config/nvim/ideavim-us.vim
endif

" ----------------------------------------------------------------------------
" IntelliJ-Specific Settings
" ----------------------------------------------------------------------------
" ideajoin: Use IntelliJ's smart join instead of Vim's default join behavior
" idearefactormode: Keep the refactoring mode consistent with IntelliJ

set ideajoin
set idearefactormode=keep
set number
set relativenumber
set commentary

" ----------------------------------------------------------------------------
" Build and Run Mappings
" ----------------------------------------------------------------------------
" Build, run, and debug operations including Android-specific builds

nnoremap <leader>bc :action CleanGradleProject<CR>
nnoremap <F5> :action Run<CR>
nnoremap <F6> :action Debug<CR>
nnoremap <F7> :action Android.SyncProject<CR>

" ----------------------------------------------------------------------------
" File and Action Search Mappings
" ----------------------------------------------------------------------------
" Quick navigation and search functionality with <leader>p prefix

nnoremap <leader>pf :action GotoFile<CR>
nnoremap <leader>pa :action GotoAction<CR>
nnoremap <leader>pt :action FindInPath<CR>

" ----------------------------------------------------------------------------
" File Operation Mappings
" ----------------------------------------------------------------------------
" Save, format, and close file operations

nnoremap <leader>ww :w<CR>:action ReformatCode<CR>
nnoremap <leader>wq <leader>ww:action CloseContent<CR>
nnoremap <leader>q :action CloseContent<CR>

" ----------------------------------------------------------------------------
" Split Management Mappings
" ----------------------------------------------------------------------------
" Manage editor splits and their orientation

" nnoremap <leader>u :action Unsplit<CR>

" ----------------------------------------------------------------------------
" Utility Mappings
" ----------------------------------------------------------------------------
" Additional utility commands

nnoremap <leader>r :action RunAnything<CR>
